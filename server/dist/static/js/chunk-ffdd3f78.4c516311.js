(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ffdd3f78"],{"0468":function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"e",(function(){return r})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return l})),i.d(e,"d",(function(){return a}));var o=i("b775");function n(t){return Object(o["c"])("/exam/api/repo/detail",t)}function r(t){return Object(o["c"])("/exam/api/repo/save",t)}function s(t){return Object(o["c"])("exam/api/repo/paging",t)}function l(t){return Object(o["c"])("/exam/api/repo/batch-action",t)}function a(t){return Object(o["b"])("/exam/api/repo/qulists/"+t)}},2934:function(t,e,i){"use strict";i.d(e,"c",(function(){return n})),i.d(e,"b",(function(){return r})),i.d(e,"a",(function(){return s})),i.d(e,"d",(function(){return l}));var o=i("b775");function n(t,e){return Object(o["c"])(t,e)}function r(t,e){return Object(o["c"])(t,{ids:e})}function s(t,e,i){return Object(o["c"])(t,{ids:e,state:i})}function l(t,e){return Object(o["c"])(t,e)}},"3e86":function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("el-form",{ref:"postForm",attrs:{model:t.postForm,rules:t.rules,"label-position":"top","label-width":"100%"}},[i("el-card",[i("el-form-item",{attrs:{label:"题库名称",prop:"title"}},[i("el-input",{model:{value:t.postForm.title,callback:function(e){t.$set(t.postForm,"title",e)},expression:"postForm.title"}})],1),i("el-form-item",{attrs:{label:"题库备注",prop:"remark"}},[i("el-input",{attrs:{type:"textarea"},model:{value:t.postForm.remark,callback:function(e){t.$set(t.postForm,"remark",e)},expression:"postForm.remark"}})],1)],1),i("h3",[t._v("选题信息")]),i("el-card",{staticStyle:{"margin-top":"20px"}},[i("div",[i("el-button",{staticClass:"filter-item",attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:t.handleAdd}},[t._v(" 添加题目 ")]),i("el-table",{staticStyle:{width:"100%","margin-top":"15px"},attrs:{data:t.repoList,border:!1,"empty-text":"请点击上面的`添加题库`进行设置"}},[i("el-table-column",{attrs:{label:"题目类型",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-select",{staticClass:"filter-item",attrs:{filterable:"",remote:"","reserve-keyword":"",clearable:"","automatic-dropdown":"",placeholder:"请选择题目类型"},on:{change:function(i){t.chageQuType(i,e.$index)}},model:{value:e.row.quType,callback:function(i){t.$set(e.row,"quType",i)},expression:"scope.row.quType"}},t._l(t.dataList,(function(t){return i("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})})),1)]}}])}),i("el-table-column",{attrs:{label:"选择题目",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"primary"},on:{click:function(i){return t.showQuestion(e.$index,e.row.quType,0)}}},[t._v("选题")])]}}])}),i("el-table-column",{attrs:{label:"选中数量",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-input-number",{staticStyle:{width:"100px"},attrs:{min:0,controls:!1,disabled:""},model:{value:e.row.quAllNum,callback:function(i){t.$set(e.row,"quAllNum",i)},expression:"scope.row.quAllNum"}})]}}])}),i("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(i){return t.showQuestion(e.$index,e.row.quType,1)}}}),i("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(i){return t.removeItem(e.$index)}}})]}}])})],1)],1)]),i("div",{staticStyle:{"margin-top":"20px"}},[i("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("保存")]),i("el-button",{attrs:{type:"info"},on:{click:t.onCancel}},[t._v("返回")])],1)],1),i("el-dialog",{attrs:{visible:t.dialogTableVisible,title:"题目"},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[i("el-input",{staticClass:"filter-item",attrs:{placeholder:"题目编码"},model:{value:t.listQuery.params.content,callback:function(e){t.$set(t.listQuery.params,"content",e)},expression:"listQuery.params.content"}}),i("el-table",{ref:"multipleTable",attrs:{data:t.chooseQuestion.gridData},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",align:"center",width:"55"}}),i("el-table-column",{attrs:{property:"code",label:"编码",align:"center"}}),i("el-table-column",{attrs:{property:"content",label:"题目",align:"center"}})],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){return t.confirmChoose(0)}}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.confirmChoose(1)}}},[t._v("确 定")])],1)],1)],1)},n=[],r=(i("ac6a"),i("0468")),s=i("2934"),l={name:"QuRepoDetail",data:function(){return{repoId:0,listUrl:"/repo/getRepoList",chooseQuestion:{index:-1,gridData:[],multipleSelection:[]},gridData:[],dataList:[{id:1,title:"单选题"},{id:4,title:"实操题"}],listQuery:{pages:1,size:10,params:{content:"",quType:0,repoIds:[]}},postForm:{},dialogTableVisible:!1,repoList:[],loading:!1,rules:{title:[{required:!0,message:"题库名称不能为空！"}]}}},watch:{listQuery:{handler:function(){this.getList()},deep:!0}},created:function(){var t=this.$route.params.id;"undefined"!==typeof t&&(this.repoId=parseInt(t),this.fetchData(t))},methods:{getList:function(){var t=this;this.listLoading=!0,this.listQuery.t=(new Date).getTime(),0!=this.listQuery.params.quType&&null!=this.listQuery.params.quType&&Object(s["c"])(this.listUrl,this.listQuery).then((function(e){t.chooseQuestion.gridData=e.data.records}))},chageQuType:function(t,e){try{this.repoList.forEach((function(i,o){if(o!=e&&i.quType==t)throw new Error("该类型已经存在，请重新选择")}))}catch(i){this.$notify({title:"失败",message:i.message,type:"error",duration:2e3}),this.repoList[e].quType=null}},confirmChoose:function(t){1==t&&(this.repoList[this.chooseQuestion.index].quLists=this.chooseQuestion.multipleSelection,this.repoList[this.chooseQuestion.index].quAllNum=this.chooseQuestion.multipleSelection.length),this.chooseQuestion={index:-1,gridData:[],multipleSelection:[]},this.dialogTableVisible=!1},handleSelectionChange:function(t){this.chooseQuestion.multipleSelection=t},removeItem:function(t){this.repoList.splice(t,1)},showQuestion:function(t,e,i){var o=this;o.listQuery.params.quType=e,1!=i||0!=o.repoList[t].quLists.length?(o.dialogTableVisible=!0,Object(r["d"])(e).then((function(e){o.chooseQuestion.index=t,o.chooseQuestion.gridData=e.data,console.log(o.chooseQuestion.gridData),0==i&&(o.chooseQuestion.multipleSelection=[]),1==i&&(o.chooseQuestion.multipleSelection=o.repoList[t].quLists,setTimeout((function(){o.chooseQuestion.gridData.forEach((function(e){o.repoList[t].quLists.forEach((function(t){t.id==e.id&&o.$refs.multipleTable.toggleRowSelection(e)}))}))}),500))}))):o.$notify({title:"失败",message:"请先选择题目！",type:"error",duration:2e3})},handleAdd:function(){this.repoList.push({quType:null,quLists:[],quAllNum:0})},fetchData:function(t){var e=this,i={id:parseInt(t)};Object(r["b"])(i).then((function(t){e.postForm=t.data,e.repoList=t.data.repoQuLists}))},submitForm:function(){var t=this;if(console.log(JSON.stringify(this.postForm)),0!=this.repoList.length){try{this.repoList.forEach((function(t){if(0==t.quLists.length)throw new Error("请选择题目")}))}catch(e){return void this.$notify({title:"失败",message:e.message,type:"error",duration:2e3})}this.$refs.postForm.validate((function(e){e&&Object(r["e"])({title:t.postForm.title,remark:t.postForm.remark,repoList:t.repoList,id:t.postForm.id}).then((function(){t.$notify({title:"成功",message:"题库保存成功！",type:"success",duration:2e3}),t.$router.push({name:"ListRepo"})}))}))}else this.$notify({title:"失败",message:"未选择题目！",type:"error",duration:2e3})},onCancel:function(){this.$router.push({name:"ListRepo"})}}},a=l,c=i("2877"),u=Object(c["a"])(a,o,n,!1,null,null,null);e["default"]=u.exports}}]);